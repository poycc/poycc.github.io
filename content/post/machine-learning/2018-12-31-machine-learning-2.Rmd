---
title: 机器学习笔记-2（线性回归的代价函数和梯度下降算法）
author: ~
date: '2018-12-31'
slug: machine-learning-2
categories: ["machine-learning"]
tags: ["note"]
---

# 线性回归算法

![](/images/post/machine-learning/13.jpg)

在上一章节中，我们由房价数据集得到上面的图形，比方说，我们来根据这个数据集，来根据房子的大小（size）来预测房价（price）应该如何去做呢？

那么，你可以做的一件事就是构建一个模型，也许是条直线：

![](/images/post/machine-learning/14.png)

从这个数据模型上来看，也许你可以告诉你的朋友，他能以大约220000(美元)左右的价格，卖掉这个房子。那么这就是监督学习算法的一个例子。

它被称作监督学习是因为对于每个数据来说，我们给出了“正确的答案”，即告诉我们，根据我们的数据来说 房子实际的价格是多少，而且，更具体来说，这是一个回归问题。

回归一词指的是我们根据之前的数据预测出一个准确的输出值。

对于这个例子就是价格，同时还有另一种最常见的监督学习方式，叫做分类问题。当我们想要预测离散的输出值，例如，如果我们正在寻找癌症肿瘤并想要确定，肿瘤是良性的还是恶性的，这就是0/1离散输出的问题。更进一步来说，在监督学习中我们有一个数据集，这个数据集被称训练集，因此对于房价的例子，我们有一个训练集，包含不同的房屋价格，我们的任务就是从这个数据中学习预测房屋价格。

![](/images/post/machine-learning/15.png)

在上图上：

* $m$：训练样本数量；
* $x$：输入变量（特征值）；
* $y$：输出变量（目标变量）。

使用$(x, y)$来表示一个训练样本，所以在这个表格中的单独的一行对应于一个训练样本，为了表示某个训练样本，使用$x$上标$(i)$与$y$上标$(i)$来表示：

$$\left(x^{(i)}, y^{(i)}\right)$$

但是需要注意的是，这里代表的不是幂函数的运算，只是表示一个索引，表示训练集里的第$i$行。

举个例子：

![](/images/post/machine-learning/16.png)

从上面的图中，我们可以获取到以下信息：

$m = 4$

$x^{(1)} = 2104, y^{(1)} = 460$

$x^{(2)} = 1416, y^{(2)} = 232$

有了这些数据之后，我们要预测一个关于$x$的线性函数$y$，有时候，我们可能会建立复杂度很大的模型，但是罗马不是一天建成了，让我们从基础开始，也就是线性方程。让我们也给这模型，起一个名字，这个模型被称为线性回归(linear regression)模型。另外，这实际上是关于单个变量的线性回归，这个变量就是$x$,根据$x$来预测所有的价格函数，同时，对于这种模型有另外一个名称，称作单变量线性回归，单变量是对一个变量的一种特别的表述方式，总而言之，这就是线性回归。

接下来使用$h$代表学习算法的解决方案或函数也称为假设（hypothesis）：

![](/images/post/machine-learning/17.png)

这就是一个监督学习算法的工作方式，我们可以看到这里有我们的训练集里房屋价格 我们把它喂给我们的学习算法，学习算法的工作了，然后输出一个函数，通常表示为小写 $h$ 表示。$h$ 代表hypothesis(假设)，$h$表示一个函数，输入是房屋尺寸大小，就像你朋友想出售的房屋，因此 $h$ 根据输入的 $x$值来得出 $y$ 值，$y$ 值对应房子的价格 因此，$h$ 是一个从$x$ 到 $y$ 的函数映射。

我将选择最初的使用规则$h$代表hypothesis，因而，要解决房价预测问题，我们实际上是要将训练集“喂”给我们的学习算法，进而学习得到一个假设$h$，然后将我们要预测的房屋的尺寸作为输入变量输入给$h$，预测出该房屋的交易价格作为输出变量输出为结果。那么，对于我们的房价预测问题，我们该如何表达 $h$？

一种可能的表达方式为：

$$h_\theta \left( x \right)=\theta_{0} + \theta_{1}x$$

上面的公式中，因为只含有一个特征/输入变量，因此这样的问题叫作单变量线性回归问题。

# 代价函数

在这段视频中我们将定义代价函数的概念，这有助于我们弄清楚如何把最有可能的直线与我们的数据相拟合。

在线性回归中我们有一个像这样的训练集：

![](/images/post/machine-learning/18.png)

$m$代表了训练样本的数量，比如 $m = 47$。而我们的假设函数，也就是用来进行预测的函数，是这样的线性函数形式：$h_\theta \left( x \right)=\theta_{0}+\theta_{1}x$。

接着我们要做的就是谈谈如何选择这两个参数值$\theta_{0}$和$\theta_{1}$，选择不同的参数θ$\theta_{0}$和$\theta_{1}$我们会得到不同的假设，不同的假设函数。

首先，我们还是来复习一下基础知识：

![](/images/post/machine-learning/19.png)

相信聪明的你看到上面的图形，已经想到了我们曾经学过的点斜式方程函数，在房价问题这个例子中便是直线的斜率([点击查看斜率的相关解释](https://enddi.cn/post/math/2018-12-14-slope-multiplication/))和在$y$轴上的截距。


我们要做的就是得出$\theta_{0}$和$\theta_{1}$这两个参数的值，来让假设函数表示的直线，尽量地与这些数据点很好的拟合。
